<!doctype html>
<html lang="en">
<head>
  <script src="https://code.jquery.com/jquery-git.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Restaurants</title>
  <meta name="description" content="High Thrills Theme Park">
  <meta name="author" content="SitePoint">
  <link rel="stylesheet" href="pnavbar.css">
  <link rel="stylesheet" href="reservation.css">
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="portal.css">
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/3aa210e078.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="">
        <div id="carouselExampleControls" class="p-carousel carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                <img class="hero d-block w-100" src="POV-theme-park_1.jpg" alt="First slide">
                </div>
                <div class="carousel-item">
                <img class="hero d-block w-100" src="POV-theme-park_1.jpg" alt="Second slide">
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        <div class="title">Ready. Set. WHOA!</div>
    </div>
    <div id="navigation"></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
    $(function() {
        $("#navigation").load("pnavbar.html");
    });
    </script>
    <div class="px-4 py-4 text-center">
        <div class="container">BLURB</div>
    </div>
    <div id="portals">
      <div class="container py-2"></div>
    </div>
    <script src="/socket.io/socket.io.js"> </script>
    <script>
      var socket = io();
      var adData = [];
      window.onload = function() {
        socket.emit("getAttractions");
      }
      socket.on("receiveAttractions", function(msg){
        console.log(msg);
        var element = $('#portals').find('.container');
        element[0].innerHTML = '';
        // construct cards through DOM
        $(function(){
          for(var i = 0; i < msg.length; ++i){
            var cardImg = document.createElement("img");
            cardImg.className = "p-img card-img";
            cardImg.src = msg[i].imagelocation;
            
            var cardTitle = document.createElement("h2");
            cardTitle.className = "card-title"
            cardTitle.innerText = msg[i].name;

            var cardHover = document.createElement("div");
            cardHover.className = "card-hover";
            cardHover.style = "width: 0%;";
            cardHover.id = msg[i].name + "-hover";

            var carrot = document.createElement("div");
            carrot.className = "portal fas fa-caret-right fa-10x float-right";
            carrot.style = "right: 1%;";
            carrot.id = msg[i].name;

            const current_name = msg[i].name;
            const current_id = msg[i].id;
            const current_name_hover = msg[i].name + "-hover";
            carrot.onclick = function() {
              for(carr of document.getElementsByClassName("portal")) {
                if(carr.id == current_name) {
                  continue;
                }
                carr.className = "portal fas fa-caret-right fa-10x float-right";
                carr.style = "right: 1%;";
              }
              for(carr of document.getElementsByClassName("card-hover")) {
                if(carr.id == current_name_hover) {
                  continue;
                }
                carr.style = "width: 0%;";
                carr.innerHTML = "";
              }
              if(document.getElementById(current_name).className == "portal fas fa-caret-left fa-10x float-right") {
                document.getElementById(current_name).className = "portal fas fa-caret-right fa-10x float-right";
                document.getElementById(current_name).style = "right: 1%;";
                document.getElementById(current_name_hover).style = "width: 0%;";
                document.getElementById(current_name_hover).innerHTML = "";
              } else {
                document.getElementById(current_name).className = "portal fas fa-caret-left fa-10x float-right";
                document.getElementById(current_name).style = "right: 46%;";
                document.getElementById(current_name_hover).style = "width: 45%;";
                socket.emit("getMenu", current_id, current_name_hover);
              }
            };

            var cardImgOverlay = document.createElement("div");
            cardImgOverlay.className = "card-img-overlay";
            cardImgOverlay.appendChild(cardHover);
            cardImgOverlay.appendChild(cardTitle);
            
            var portal = document.createElement("a");
            portal.href = msg[i].page_address;
            portal.appendChild(cardImg);
            portal.appendChild(cardImgOverlay);

            var card = document.createElement("div");
            card.className = "card my-3 border-0 text-white";
            card.appendChild(portal);
            card.appendChild(carrot);

            element[0].appendChild(card);
          }
        });
      });
      
      socket.on("receiveMenu", function(menuData, current_name_hover) {
        var menu = document.createElement("div");
        for (item of menuData) {
          var menuItem = document.createElement("p");
          menuItem.innerHTML = item.foodName;
          //menuItem.innerHTML = item.cost;
          menu.appendChild(menuItem);
        }

        document.getElementById(current_name_hover).appendChild(menu);
      });
      
    </script>
    <footer>
        <div style="width: 100vw; background-image: url(https://www.worldatlas.com/r/w1200-h630-c1200x630/upload/0e/f9/19/theme-parks.jpg)">
            <img style="filter: brightness(50%); width:100%; height: 200px; object-fit:cover;" src="https://www.worldatlas.com/r/w1200-h630-c1200x630/upload/0e/f9/19/theme-parks.jpg">
            <!--<button class=" btn btn-outline-primary mr-2" data-toggle="modal" data-target="#signUpModal">Sign Up</button>
        <button class=" btn btn-outline-success" data-toggle="modal" data-target="#loginModal">Log In</button>-->
        </div>
        <div id="footer"></div>
        <script>
            $(function() {
            $("#footer").load("pfooter.html");
            });
        </script>
    </footer>
</body>